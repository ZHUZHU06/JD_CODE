/*
苹果CEO库克杜克大学演讲：毕业生要无所畏惧
文章来源：未知 文章作者：enread 发布时间：2020-05-14 13:31 字体： [大 中 小]　 进入论坛
(单词翻译:双击或拖选)
　　Apple CEO Tim Cook gave a commencement speech to new graduates of Duke University on Sunday.
　　He says that despite major issues like inequality, climate change, and political division, technology has made this 'the best time in history to be alive.'
 
　　Cook also encouraged Duke grads to be 'fearless,' like the women of the MeToo movement or the survivors1 of the Parkland school shooting.
 
　　苹果CEO蒂姆·库克(Tim Cook)周末在杜克大学的毕业典礼上发表演讲。他在演讲中鼓励杜克大学毕业生无所畏惧;关于数据隐私策略，他表示苹果采取了与其他科技公司不同的做法。
 
　　库克鼓励杜克大学毕业生无所畏惧，还向Parkland校园枪击案的幸存者，以及那些捍卫移民权利的人士致敬。
 
　　Hello, Blue Devils! It’s great to be back.
　　Hi，蓝魔们(杜克大学别名)，我很高兴回到这里。
 
　　It’s an honor to stand before you—both as your commencement speaker and a fellow Duke graduate.
　　很荣幸能够站在大家的面前，你们都是毕业典礼的主角，也是杜克大学最新的毕业生。
 
　　I earned my degree from the Fuqua School in 1988. In preparing for this speech, I reached out to one of my favorite professors from back then. Bob Reinheimer taught a great course in Management Communications, which included sharpening your public speaking skills.
　　我在1988年获得了福库商学院的学位。在准备这次演讲的时候，我与当时最喜欢的一位教授取得了联系。他的名字叫做鲍勃-雷宁海默(Bob Reinheimer)，负责“管理交流”课程的教学，这门课程可以提高你们的演讲技巧。
 
　　We hadn’t spoken for decades, so I was thrilled when he told me: he remembered a particularly gifted public speaker who took his class in the 1980s…With a bright mind and a charming personality!
　　我们已经有几十年没有联系过了，所以当他告诉我可以在母校演讲之后，我很激动。他说他想起了一位在上世纪80年代教过的学生，不仅极具演讲天赋，而且还有聪明的头脑和迷人的个性。
 
　　He said he knew—way back then—this person was destined3 for greatness.
　　他说当时他就知道，这个人注定不平凡。
 
　　You can imagine how this made me feel. Professor Reinheimer had an eye for talent. And, if I do say so, I think his instincts were right…
　　你能想象听到这些赞美后我是什么感觉，雷宁海默对人才一向有着敏锐的嗅觉，如果非要我评价的话，我觉得他的看法都是正确的。
 
　　Melinda Gates has really made her mark on the world. I’m grateful to Bob, Dean Boulding, and all of my Duke professors. Their teachings have stayed with me throughout my career.
　　梅琳达-盖茨(Melinda Gates，比尔盖茨夫人)之前也来过这里演讲，我很感激鲍勃、迪安-博尔丁(Dean Boulding)和所有教过我的杜克大学教授。在我的职业生涯中，他们的谆谆教导一直陪伴着我。
 
　　I want to thank President Price, the Duke Faculty4, and my fellow members of the Board of Trustees for the honor of speaking with you today. I’d also like to recognize this year’s honorary degree recipients5.
　　我还要感谢普莱斯(Price)主席、杜克大学的教职人员以及其他董事会成员，感谢他们愿意与大家交流，我也想感谢在座所有获得学位的人。
 
　　And most of all, congratulations to the class of 2018!
　　最重要的是，祝贺大家成为2018届杜克大学毕业生!
 
　　No graduate gets to this moment alone. I want to acknowledge your parents, grandparents and friends here cheering you on, just as they have every step of the way. Let’s give them our thanks.
　　没有人能只靠自己取得成绩，因此我还要替大家感谢你们的父母、祖父母和为你们加油的朋友，就像他们每天陪伴你们一样，让我们向他们表示感谢。
 
　　Today especially, I remember my mother, who watched me graduate from Duke. I wouldn’t have been there that day—or made it here today—without her support.
　　今天，让我想起了我的母亲，她看着我从杜克大学毕业。如果没有她的支持，我当年不会站在这里，今天更不会站在这里。
 
　　Let’s give our special thanks to all the mothers here today, on Mother’s Day.
　　今天是母亲节，在这里我们要特别感谢所有的母亲。
 
　　I have wonderful memories here. Studying—and not studying—with people I still count as friends to this day. Cheering at Cameron for every victory. Cheering even louder when that victory is over Carolina.
　　在这里我保存了美好的回忆，和一些今天依然还是朋友的人不仅在一起学习，还为每一次胜利欢呼。
 
　　Look back over your shoulder fondly and say goodbye to act one of your life. And then quickly look forward. Act two begins today. It’s your turn to reach out and take the baton6.
　　当我们深情的回顾这几年，你会发现现在到了告别过去的时光、继续向前看的时候了。从今天开始行动，生活由你们自己掌控。
 
　　You enter the world at a time of great challenge.
　　你们活在一个充满挑战的时代与世界。
 
　　Our country is deeply divided—and too many Americans refuse to hear any opinion that differs from their own.
　　我们的国家现在存在严重的分歧，太多的美国人拒绝听取任何与自己不同的意见。
 
　　Our planet is warming with devastating7 consequences—and there are some who deny it’s even happening.
　　我们的星球正在变暖，未来会有毁灭性的后果，但有人却否认这样的现实。
 
　　Our schools and communities suffer from deep inequality—we fail to guarantee every student the right to a good education.
　　我们的学校和社区都在遭受着严重的不平等待遇，不能保证每个学生都能接受良好的教育。
 
　　And yet we are not powerless in the face of these problems. You are not powerless to fix them.
　　但面对这些问题，我们并非无能为力，可以通过自己的努力去纠正它。
 
　　No generation has ever held more power than yours. And no generation has been able to make change happen faster than yours can. The pace at which progress is possible has accelerated dramatically. Aided by technology, every individual has the tools, potential, and reach to build a better world.
　　没有哪一代人比你们拥有更强大的力量，没有哪一代人比你们能够更快的做出改变。我们现在实现目标的速度已经大幅缩短，在科技的帮助下，每个人都可以通过工具、潜能和自己的能力建设一个更美好的世界。
 
　　That makes this the best time in history to be alive. Whatever you choose to do with your life…Wherever your passion takes you.
　　这是有史以来最好的时代，无论你选择如何对待自己的生活，也无论你将自己的激情燃烧在哪里。
 
　　I urge you to take the power you have been given and use it for good. Aspire8 to leave this world better than you found it.
　　我希望大家能好好利用自己的力量，这个世界远远要比你想象得更美好。
 
　　I didn’t always see life as clearly as I do now. But I’ve learned the greatest challenge of life is knowing when to break with conventional wisdom.
　　其实我也并非总是能够清晰的看清自己，但我明白，人生最大的挑战就是拥有知道何时打破传统的智慧与勇气。
 
　　Don’t just accept the world you inherit today.Don’t just accept the status quo.
 
　　不要只是一昧的接受今天你所生活的世界，不要安于现状。
 
　　No big challenge has ever been solved, and no lasting9 improvement has ever been achieved, unless people dare to try something different. Dare to think different.
 
　　没有无法突破的挑战、没有永远不会进步的人，大家要敢于尝试不同的东西，要敢于“非同凡想”(Think Different)。
 
　　I was lucky to learn from someone who believed this deeply. Someone who knew that changing the world starts with “following a vision, not a path.” He was my friend and mentor10, Steve Jobs.
　　我很幸运，能够从一位坚信这条理念的人那里学习很多东西。他之所以能够改变世界，就是因为他坚信要追随自己的理想，不能循规蹈矩。他就是我的朋友和导师，史蒂夫-乔布斯。
 
　　Steve’s vision was that great ideas come from a restless refusal to accept things as they are. And those principles still guide us at Apple today.
　　史蒂夫认为，伟大的思想来自于不安分的内心以及拒绝接受事情的现状。这些原则在今天依然指引着苹果的发展方向。
 
　　We reject the notion that global warming is inevitable11. That’s why we run Apple on 100% renewable energy.
　　我们坚决反对全球变暖，这就是为什么我们要用百分之百的可再生资源来维持苹果的运营。
 
　　We reject the excuse that getting the most out of technology means trading away your right to privacy. So we choose a different path: Collecting as little of your data as possible. Being thoughtful and respectful when it’s in our care. Because we know it belongs to you.
　　我们拒绝以技术为借口，剥夺用户的隐私权。因此苹果选择了一条不同的道路：尽可能不去收集用户数据，我们非常尊重用户的权力和思想，因此我们知道这一切都属于用户。
 
　　In every way, at every turn, the question we ask ourselves is not ‘what can we do’ but ‘what should we do’.
　　在每一个方面、每一个转折点，我们要问自己的问题不是“我能做什么”，而是“我应该做什么”。
 
　　Because Steve taught us that’s how change happens. And from him I learned to never be content with things as they are.
　　在每一个方面、每一个转折点，我们要问自己的问题不是“我能做什么”，而是“我应该做什么”。
 
　　I believe this mindset comes naturally to young people…and you should never let go of that restlessness.
　　我相信这种心态对年轻人来说是顺其自然的事情，你们不要放弃这种年轻人的特质。
 
　　So today’s ceremony isn’t just about presenting you with a degree, it’s about presenting you with a question.
　　所以今天的仪式不仅仅是授予大家学位，而是向大家提出了一个问题。
 
　　How will you challenge the status quo? How will you push the world forward?
　　你们会如何挑战现状?如何推动世界的发展?
 
　　Fifty years ago today—May 13th, 1968—Robert Kennedy was campaigning in Nebraska, and spoke2 to a group of students who were wrestling with that same question.
　　50年前的今天，1968年5月13日，罗伯特.肯尼迪(Robert Kennedy)在内斯加州参加竞选，同样与一群备受困扰的学生们进行了交谈。
 
　　Those were troubled times, too. The U.S. was at war in Vietnam. There was violent unrest in America’s cities. And the country was still reeling from the assassination12 of Dr. Martin Luther King a month earlier.
　　这是非常困难的时期，当时美国在越南处于战争状态，在美国国内的城市里也爆发了暴力和骚乱。一个月之前，马丁.路德金(Martin Luther King)博士被害，这个国家蹒跚前行。
 
　　Kennedy gave the students a call to action. When you look across this country, and when you see peoples’ lives held back by discrimination and poverty… when you see injustice13 and inequality. He said, you should be the last people to accept things as they are.
　　肯尼迪向学生们发起了行动的号召，当你们看到这个国家里许多人被贫困和歧视深深困扰、看到他们遭遇不公平和不公正的对待时，你应该是最后一个放弃的人。
 
　　Let Kennedy’s words echo here today.
　　肯尼迪的话在今天依然还萦绕在我们的脑海中。
 
　　“You should be the last people to accept [it].”Whatever path you’ve chosen…Be it medicine, business, engineering, the humanities—whatever drives your passion.
　　无论你选择什么道路，医学、商业、工程、人文学科，无论什么都会激发你的热情。
 
　　Be the last to accept the notion that the world you inherit cannot be improved.
　　即使这个世界无法改变，你也应该是最后一个放弃努力的人。
 
　　Be the last to accept the excuse that says, “that’s just how things are done here.” Duke graduates, you should be the last people to accept it. And you should be the first to change it.
　　你们要做最后接受“完成工作必须要这样”的借口 的那个人。杜克大学的毕业生们，除了最后一个放弃努力之外，还应该是第一个改变它的人。
 
　　The world-class education you’ve received—that you’ve worked so hard for—gives you opportunities that few people have.
　　你们所接受的都是世界一流的教育，你应该为之努力奋斗，因为并不是所有人都有这样的机会。
 
　　You are uniquely qualified14, and therefore uniquely responsible, to build a better way forward. That won’t be easy. It will require great courage.
　　你们有这样的资格，因此也要承担这样的责任，来更好的努力 。这并不容易，还需要很大的勇气。
 
　　But that courage will not only help you live your life to the fullest—it will empower you to transform the lives of others.
　　但这种勇气不仅能帮助你们拥有更充实的生活，而且还能改变别人的生活。
 
　　Last month I was in Birmingham to mark the fiftieth anniversary of Dr. King’s assassination. And I had the incredible privilege of spending time with women and men who marched and worked alongside him.
　　上个月我前往伯明翰参加了马丁.路德金逝世50周年纪念活动。我有幸和那些曾与马丁.路德金共同前进和工作的人们共处了一段时间。
 
　　Many of them were younger at the time than you are now. They told me that when they defied their parents and joined the sit-ins and boycotts15, when they faced the police dogs and firehoses, they were risking everything they had—becoming foot soldiers for justice without a second thought.
　　在那个时代，他们中的很多人和你们现在一样青春年少。他们对我说，当他们违背了父母的意愿，加入了静坐和抵制活动时，他们那时面对的是警犬和消防水管，他们那时冒着失去一切的风险——但是他们依然毫不犹豫的成为了捍卫公正的斗士。
 
　　Because they knew that change had to come.
　　因为他们当时深知改变将会到来。
 
　　Because they believed so deeply in the cause of justice.
　　因为他们当时深信公正的力量。
 
　　Because they knew, even with all the adversity they had faced, they had the chance to build something better for the next generation.
　　因为他们知道，尽管自己正处于逆境，但是他们有机会为后人铺设一条更好的道路。
 
　　We can all learn from their example. If you hope to change the world, you must find your fearlessness.
　　我们都应该以他们为榜样，向他们学习。如果你希望改变世界，你就必须找到自己无畏的那一面。
 
　　Now, if you’re anything like I was on graduation day, maybe you’re not feeling so fearless.
　　此时此刻，你可能像我毕业那天一样，完全没有觉得无所畏惧。
 
　　Maybe you’re thinking about the job you hope to get, or wondering where you’re going to live, or how to repay that student loan. These, I know, are real concerns. I had them, too. But don’t let those worries stop you from making a difference.
　　现在，也许身处毕业典礼的你们正在考虑自己将来的工作、不知道未来会住在哪里、还在为如何偿还学生贷款发愁。我知道这些都是应该担忧的事情，但不要让这些阻碍妨碍你做出改变。
 
　　Fearlessness means taking the first step, even if you don’t know where it will take you. It means being driven by a higher purpose, rather than by applause. It means knowing that you reveal your character when you stand apart, more than when you stand with the crowd.
　　无畏意味着勇敢迈出第一步，即使你不知道它会将你带往何处。也许驱使你的是更崇高的目标、也许是周围人的目光。当你独自一人的时候，才会看到自己真正的问题，而不是与大家站在一起的时候。
 
　　If you step up, without fear of failure… if you talk and listen to each other, without fear of rejection… if you act with decency16 and kindness, even when no one is looking, even if it seems small or inconsequential, trust me, the rest will fall into place.
　　如果你迈出了这一步，不怕失败……如果你和其他人进行对话，并且倾听，不怕被拒绝……如果你内心深处拥有善良与正直，那么就算暂时没有人了解你、就算现在你无关紧要，相信我，属于你的时代早晚都会到来。
 
　　More importantly, you’ll be able to tackle the big things when they come your way. It’s in those truly trying moments that the fearless inspire us.
　　更重要的是，当你的时代来临时，就能找到解决问题的方法。在一次又一次的尝试中，正是无所畏惧的精神激励着我们。
 
　　Fearless like the students of Parkland, Florida—who refuse to be silent about the epidemic17 of gun violence, and have rallied millions to their cause.
　　就像佛罗里达州帕克兰学校的学生们一样，他们不惧怕枪支暴力带来的威胁，并没有保持沉默，而是为了目标团结了数百万人。
 
　　Fearless like the women who say “me, too” and “time’s up”… women who cast light into dark places, and move us toward a more just and equal future.
　　还有那些勇于站出来对性骚扰“说不”的女性，她们的光辉照耀到了最黑暗的地方，让我们朝着更加公正和公平的未来前进。
 
　　Fearless like those who fight for the rights of immigrants… who understand that our only hopeful future is one that embraces all who want to contribute.
　　像那些为了争取自己移民权力而斗争的人一样，他们明白只要有所贡献，就能构建一个美好的未来。
 
　　Duke graduates, be fearless.
　　杜克大学的毕业生们，你们要无所畏惧。
 
　　Be the last people to accept things as they are, and the first people to stand up and change them for the better.
　　要成为最后一个放弃的人，也要成为第一个为更好的生活奋斗而站出来的人。
 
　　In 1964, Martin Luther King, Jr. gave a speech at Page Auditorium18 to an overflow19 crowd. Students who couldn’t get a seat listened from outside on the lawn. Dr. King warned them that someday we would all have to atone20, not only for the words and actions of the bad people, but for “the appalling21 silence and indifference22 of the good people, who sit around and say, ‘Wait on time.’”
　　1964年，马丁-路德金在发表演讲时，台下坐满了人，那些没有座位的学生则拥挤在草坪上。那时路德金博士就告诫学生们，人们总有一天都要为自己的行为付出代价，作恶的坏人如此，那些沉默和冷漠的“好人”也是如此。
 
　　Martin Luther King stood right here at Duke, and said: “The time is always right to do right.” For you, graduates, that time is now.
　　马丁-路德金曾在杜克大学说过：“只要做对的事情，永远都是最好的时机。对你们来说，毕业生们，现在是时候行动了。”
 
　　It will always be now. It’s time to add your brick to the path of progress.
　　做对的事情，永远都不会太晚。现在就是你们给这条道路添砖加瓦的时候。
 
　　It’s time for all of us to move forward.
　　现在是我们所有人前进的时候。
 
　　And it’s time for you to lead the way.
　　现在是你带领人们前进的时候。
 
　　Thank you—and congratulations, Class of 2018!
　　谢谢大家，祝贺你们，2018届的毕业生们。





抽奖机
活动入口：APP中各种抽奖活动的汇总
/*
京东抽奖机
更新时间：2021-02-14 14:09
脚本说明：抽奖活动,有新活动可以@我或者提Issues
脚本兼容: QuantumultX, Surge, Loon, JSBox, Node.js
// quantumultx
[task_local]
#京东抽奖机
11 1 * * * https://raw.githubusercontent.com/yangtingxiao/QuantumultX/master/scripts/jd/jd_lotteryMachine.js, tag=京东抽奖机, img-url=https://raw.githubusercontent.com/yangtingxiao/QuantumultX/master/image/jdlottery.png, enabled=true
// Loon
[Script]
cron "11 1 * * *" script-path=https://raw.githubusercontent.com/yangtingxiao/QuantumultX/master/scripts/jd/jd_lotteryMachine.js,tag=京东抽奖机
// Surge
京东抽奖机 = type=cron,cronexp=11 1 * * *,wake-system=1,timeout=20,script-path=https://raw.githubusercontent.com/yangtingxiao/QuantumultX/master/scripts/jd/jd_lotteryMachine.js
 */
const $ = new Env('京东抽奖机');
const STRSPLIT = "|";
const needSum = false;            //是否需要显示汇总
const printDetail = false;        //是否显示出参详情
const appIdArr = ['1EFRRxA','1EFRQwA','1EFRTyg','1EFRSyw','1EFRXxg']
const shareCodeArr = ['']
const homeDataFunPrefixArr = ['interact_template','interact_template','','','','','','','','','','','','','','']
const collectScoreFunPrefixArr = ['','','','','','','','','','','','','','','']
const lotteryResultFunPrefixArr = ['','','','','','','','','','','','','','','','']
let merge = {}
//IOS等用户直接用NobyDa的jd cookie
let cookiesArr = [], cookie = '';
const JD_API_HOST = `https://api.m.jd.com/client.action`;
!(async () => {
  await requireConfig()
  if (!cookiesArr[0]) {
    $.msg($.name, '【提示】请先获取cookie\n直接使用NobyDa的京东签到获取', 'https://bean.m.jd.com/', {"open-url": "https://bean.m.jd.com/"});
    return;
  }
  for (let i = 0; i < cookiesArr.length; i++) {
    cookie = cookiesArr[i];
    if (cookie) {
      if (i) console.log(`\n***************开始京东账号${i + 1}***************`)
      initial();
      await  QueryJDUserInfo();
      if (!merge.enabled)  //cookie不可用
      {
        $.setdata('', `CookieJD${i ? i + 1 : "" }`);//cookie失效，故清空cookie。
        $.msg($.name, `【提示】京东账号${i + 1} cookie已过期！请先获取cookie\n直接使用NobyDa的京东签到获取`, 'https://bean.m.jd.com/', {"open-url": "https://bean.m.jd.com/"});
        continue;
      }
      for (let j in appIdArr) {
        //j = appIdArr.length - 1
        appId = appIdArr[j]
        shareCode = shareCodeArr[j]
        homeDataFunPrefix = homeDataFunPrefixArr[j]||'healthyDay'
        collectScoreFunPrefix = collectScoreFunPrefixArr[j]||'harmony'
        lotteryResultFunPrefix = lotteryResultFunPrefixArr[j]||'interact_template'
        browseTime = 6
        if (parseInt(j)) console.log(`\n开始第${parseInt(j) + 1}个抽奖活动`)
        await interact_template_getHomeData();
        //break
      }
      await msgShow();
      //break
    }
  }
})()
  .catch((e) => $.logErr(e))
  .finally(() => $.done())

//获取昵称
function QueryJDUserInfo(timeout = 0) {
  return new Promise((resolve) => {
    setTimeout( ()=>{
      let url = {
        url : `https://wq.jd.com/user/info/QueryJDUserInfo?sceneval=2`,
        headers : {
          'Referer' : `https://wqs.jd.com/my/iserinfo.html`,
          'Cookie' : cookie
        }
      }
      $.get(url, (err, resp, data) => {
        try {
          data = JSON.parse(data);
          if (data.retcode === 13) {
            merge.enabled = false
            return
          }
          merge.nickname = data.base.nickname;
        } catch (e) {
          $.logErr(e, resp);
        } finally {
          resolve()
        }
      })
    },timeout)
  })
}
//获取活动信息
function interact_template_getHomeData(timeout = 0) {
  return new Promise((resolve) => {
    setTimeout( ()=>{
      let url = {
        url : `${JD_API_HOST}`,
        headers : {
          'Origin' : `https://h5.m.jd.com`,
          'Cookie' : cookie,
          'Connection' : `keep-alive`,
          'Accept' : `application/json, text/plain, */*`,
          'Referer' : `https://h5.m.jd.com/babelDiy/Zeus/2WBcKYkn8viyxv7MoKKgfzmu7Dss/index.html`,
          'Host' : `api.m.jd.com`,
          'Accept-Encoding' : `gzip, deflate, br`,
          'Accept-Language' : `zh-cn`
        },
        body : `functionId=${homeDataFunPrefix}_getHomeData&body={"appId":"${appId}","taskToken":""}&client=wh5&clientVersion=1.0.0`
      }

      $.post(url, async (err, resp, data) => {
        try {
          if (printDetail) console.log(data);
          data = JSON.parse(data);
          if (data.data.bizCode !== 0) {
            console.log(data.data.bizMsg);
            merge.jdBeans.fail++;
            merge.jdBeans.notify = `${data.data.bizMsg}`;
            return
          }
          scorePerLottery = data.data.result.userInfo.scorePerLottery||data.data.result.userInfo.lotteryMinusScore
          if (data.data.result.raiseInfo&&data.data.result.raiseInfo.levelList) scorePerLottery = data.data.result.raiseInfo.levelList[data.data.result.raiseInfo.scoreLevel];
          //console.log(scorePerLottery)
          for (let i = 0;i < data.data.result.taskVos.length;i ++) {
            console.log("\n" + data.data.result.taskVos[i].taskType + '-' + data.data.result.taskVos[i].taskName  + '-' + (data.data.result.taskVos[i].status === 1 ? `已完成${data.data.result.taskVos[i].times}-未完成${data.data.result.taskVos[i].maxTimes}` : "全部已完成"))
            //签到
            if (data.data.result.taskVos[i].status === 3) {
              console.log('开始抽奖')
              await interact_template_getLotteryResult(data.data.result.taskVos[i].taskId);
              continue;
            }
            if ([0,13].includes(data.data.result.taskVos[i].taskType)) {
              if (data.data.result.taskVos[i].status === 1) {
                await harmony_collectScore(data.data.result.taskVos[i].simpleRecordInfoVo.taskToken,data.data.result.taskVos[i].taskId);
              }
              continue
            }
            if ([14,6].includes(data.data.result.taskVos[i].taskType)) {
              //console.log(data.data.result.taskVos[i].assistTaskDetailVo.taskToken)
              if (cookiesArr.indexOf(cookie) === 0) {
                shareCodeArr[appIdArr.indexOf(appId)] = data.data.result.taskVos[i].assistTaskDetailVo.taskToken
              }
              if (shareCode) await harmony_collectScore(shareCode,data.data.result.taskVos[i].taskId);
              for (let j = 0;j <(data.data.result.userInfo.lotteryNum||0);j++) {
                if (appId === "1EFRTxQ") {
                  await ts_smashGoldenEggs()
                }  else {
                  await interact_template_getLotteryResult(data.data.result.taskVos[i].taskId);
                }
              }
              continue
            }
            let list = data.data.result.taskVos[i].productInfoVos || data.data.result.taskVos[i].followShopVo || data.data.result.taskVos[i].shoppingActivityVos || data.data.result.taskVos[i].browseShopVo
            if (data.data.result.taskVos[i].subTitleName.match(/(\d+)(s)/)) {
              browseTime = parseInt(data.data.result.taskVos[i].subTitleName.match(/(\d+)(s)/)[0])
            }
            for (let k = data.data.result.taskVos[i].times; k < data.data.result.taskVos[i].maxTimes; k++) {
              for (let j in list) {
                if (list[j].status === 1) {
                  //console.log(list[j].simpleRecordInfoVo||list[j].assistTaskDetailVo)
                  console.log("\n" + (list[j].title || list[j].shopName||list[j].skuName))
                  //console.log(list[j].itemId)
                  if (list[j].itemId) {
                    await harmony_collectScore(list[j].taskToken,data.data.result.taskVos[i].taskId,list[j].itemId,1);
                    if (k === data.data.result.taskVos[i].maxTimes - 1) await interact_template_getLotteryResult(data.data.result.taskVos[i].taskId);
                  } else {
                    await harmony_collectScore(list[j].taskToken,data.data.result.taskVos[i].taskId)
                  }
                  list[j].status = 2;
                  break;
                } else {
                  continue;
                }
              }
            }
          }
          if (scorePerLottery) await interact_template_getLotteryResult();
          //for (let j = 0;j <(data.data.result.userInfo.lotteryNum||0 && appId === "1EFRTxQ");j++) {
          //    await ts_smashGoldenEggs()
          //}
        } catch (e) {
          $.logErr(e, resp);
        } finally {
          resolve()
        }
      })
    },timeout)
  })
}
//做任务
function harmony_collectScore(taskToken,taskId,itemId = "",actionType = 0,timeout = 0) {
  return new Promise((resolve) => {
    setTimeout( ()=>{
      let url = {
        url : `${JD_API_HOST}`,
        headers : {
          'Origin' : `https://h5.m.jd.com`,
          'Cookie' : cookie,
          'Connection' : `keep-alive`,
          'Accept' : `application/json, text/plain, */*`,
          'Referer' : `https://h5.m.jd.com/babelDiy/Zeus/2WBcKYkn8viyxv7MoKKgfzmu7Dss/index.html`,//?inviteId=P225KkcRx4b8lbWJU72wvZZcwCjVXmYaS5jQ P225KkcRx4b8lbWJU72wvZZcwCjVXmYaS5jQ?inviteId=${shareCode}
          'Host' : `api.m.jd.com`,
          'Accept-Encoding' : `gzip, deflate, br`,
          'Accept-Language' : `zh-cn`
        },
        body : `functionId=${collectScoreFunPrefix}_collectScore&body={"appId":"${appId}","taskToken":"${taskToken}","taskId":${taskId}${itemId ? ',"itemId":"'+itemId+'"' : ''},"actionType":${actionType}&client=wh5&clientVersion=1.0.0`
      }
      //console.log(url.body)
      //if (appId === "1EFRTxQ") url.body += "&appid=golden-egg"
      $.post(url, async (err, resp, data) => {
        try {
          if (printDetail) console.log(data);
          data = JSON.parse(data);
          console.log(data.data.bizMsg)
          if (data.data.bizMsg === "任务领取成功") {
            await harmony_collectScore(taskToken,taskId,itemId,0,parseInt(browseTime) * 1000);
          }
        } catch (e) {
          $.logErr(e, resp);
        } finally {
          resolve()
        }
      })
    },timeout)
  })
}
//抽奖
function interact_template_getLotteryResult(taskId,timeout = 0) {
  return new Promise((resolve) => {
    setTimeout( ()=>{
      let url = {
        url : `${JD_API_HOST}`,
        headers : {
          'Origin' : `https://h5.m.jd.com`,
          'Cookie' : cookie,
          'Connection' : `keep-alive`,
          'Accept' : `application/json, text/plain, */*`,
          'Referer' : `https://h5.m.jd.com/babelDiy/Zeus/2WBcKYkn8viyxv7MoKKgfzmu7Dss/index.html?inviteId=P04z54XCjVXmYaW5m9cZ2f433tIlGBj3JnLHD0`,//?inviteId=P225KkcRx4b8lbWJU72wvZZcwCjVXmYaS5jQ P225KkcRx4b8lbWJU72wvZZcwCjVXmYaS5jQ
          'Host' : `api.m.jd.com`,
          'Accept-Encoding' : `gzip, deflate, br`,
          'Accept-Language' : `zh-cn`
        },
        body : `functionId=${lotteryResultFunPrefix}_getLotteryResult&body={"appId":"${appId}"${taskId ? ',"taskId":"'+taskId+'"' : ''}}&client=wh5&clientVersion=1.0.0`
      }
      //console.log(url.body)
      //if (appId === "1EFRTxQ") url.body = `functionId=ts_getLottery&body={"appId":"${appId}"${taskId ? ',"taskId":"'+taskId+'"' : ''}}&client=wh5&clientVersion=1.0.0&appid=golden-egg`
      $.post(url, async (err, resp, data) => {
        try {
          if (printDetail) console.log(data);
          if (!timeout) console.log('\n开始抽奖')
          data = JSON.parse(data);
          if (data.data.bizCode === 0) {
            if (data.data.result.userAwardsCacheDto.jBeanAwardVo) {
              merge.jdBeans.success++;
              console.log('京豆:' + data.data.result.userAwardsCacheDto.jBeanAwardVo.quantity)
              merge.jdBeans.prizeCount += parseInt(data.data.result.userAwardsCacheDto.jBeanAwardVo.quantity)
            }
            if (data.data.result.userAwardsCacheDto.redPacketVO) {
              merge.redPacket.show = true;
              merge.redPacket.success++;
              console.log('红包:' + data.data.result.userAwardsCacheDto.redPacketVO.value)
              merge.redPacket.prizeCount += parseFloat(data.data.result.userAwardsCacheDto.redPacketVO.value)
            }
            if (data.data.result.raiseInfo) scorePerLottery = parseInt(data.data.result.raiseInfo.nextLevelScore);
            if (parseInt(data.data.result.userScore) >= scorePerLottery && scorePerLottery) {
              await interact_template_getLotteryResult(1000)
            }
          } else{
            merge.jdBeans.fail++;
            console.log(data.data.bizMsg)
            if (data.data.bizCode === 111 ) data.data.bizMsg = "无机会"
            merge.jdBeans.notify = `${data.data.bizMsg}`;
          }
        } catch (e) {
          $.logErr(e, resp);
        } finally {
          resolve()
        }
      })
    },timeout)
  })
}

function requireConfig() {
  return new Promise(resolve => {
    //Node.js用户请在jdCookie.js处填写京东ck;
    const jdCookieNode = $.isNode() ? require('./jdCookie.js') : '';
    //IOS等用户直接用NobyDa的jd cookie
    if ($.isNode()) {
      Object.keys(jdCookieNode).forEach((item) => {
        if (jdCookieNode[item]) {
          cookiesArr.push(jdCookieNode[item])
        }
      })
    } else {
      let cookiesData = $.getdata('CookiesJD') || "[]";
      cookiesData = jsonParse(cookiesData);
      cookiesArr = cookiesData.map(item => item.cookie);
      cookiesArr.reverse();
      cookiesArr.push(...[$.getdata('CookieJD2'), $.getdata('CookieJD')]);
      cookiesArr.reverse();
      cookiesArr = cookiesArr.filter(item => item !== "" && item !== null && item !== undefined);
    }
    console.log(`共${cookiesArr.length}个京东账号\n`);
    resolve()
  })
}

function jsonParse(str) {
  if (typeof str == "string") {
    try {
      return JSON.parse(str);
    } catch (e) {
      console.log(e);
      $.msg($.name, '', '请勿随意在BoxJs输入框修改内容\n建议通过脚本去获取cookie')
      return [];
    }
  }
}

//初始化
function initial() {
   merge = {
     nickname: "",
     enabled: true,
     redPacket: {prizeDesc : "抽得|红包|元",number : true,fixed : 2},  //定义 动作|奖励名称|奖励单位   是否是数字
     jdBeans: {prizeDesc : "抽得|京豆|个",number : true,fixed : 0}
  }
  for (let i in merge) {
    merge[i].success = 0;
    merge[i].fail = 0;
    merge[i].prizeCount = 0;
    merge[i].notify = "";
    merge[i].show = true;
  }
  merge.redPacket.show = false;
}
//通知
function msgShow() {
  let message = "";//https://h5.m.jd.com/babelDiy/Zeus/YgnrqBaEmVHWppzCgW8zjZj3VjV/index.html
  let url ={ "open-url" : `openapp.jdmobile://virtual?params=%7B%22category%22%3A%22jump%22%2C%22des%22%3A%22m%22%2C%22url%22%3A%22https%3A%2F%2Fbean.m.jd.com%2FbeanDetail%2Findex.action%3FresourceValue%3Dbean%22%7D`}
  let title = `京东账号：${merge.nickname}`;
  for (let i in merge) {
    if (typeof (merge[i]) !== "object" || !merge[i].show) continue;
    if (merge[i].notify.split("").reverse()[0] === "\n") merge[i].notify = merge[i].notify.substr(0,merge[i].notify.length - 1);
    message += `${merge[i].prizeDesc.split(STRSPLIT)[0]}${merge[i].prizeDesc.split(STRSPLIT)[1]}：` + (merge[i].success ? `${merge[i].prizeCount.toFixed(merge[i].fixed)}${merge[i].prizeDesc.split(STRSPLIT)[2]}\n` : `失败：${merge[i].notify}\n`)
  }
//合计
  if (needSum) {
    $.sum = {};
    for (let i in merge) {
      if (typeof (merge[i]) !== "object" || !merge[i].show) continue;
      if (typeof ($.sum[merge[i].prizeDesc.split(STRSPLIT)[1]]) === "undefined")  $.sum[merge[i].prizeDesc.split(STRSPLIT)[1]] = {count : 0};
      $.sum[merge[i].prizeDesc.split(STRSPLIT)[1]].count += merge[i].prizeCount;
    }
    message += `合计：`
    for (let i in $.sum)
    {
      message += `${$.sum[i].count.toFixed($.sum[i].fixed)}${i}，`
    }
  }
  message += `请点击通知跳转至APP查看`
  //message = message.substr(0,message.length - 1);
  $.msg($.name, title, message, url);
}



function Env(t,e){class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`\ud83d\udd14${this.name}, \u5f00\u59cb!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),a={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(a,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t){let e={"M+":(new Date).getMonth()+1,"d+":(new Date).getDate(),"H+":(new Date).getHours(),"m+":(new Date).getMinutes(),"s+":(new Date).getSeconds(),"q+":Math.floor(((new Date).getMonth()+3)/3),S:(new Date).getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,((new Date).getFullYear()+"").substr(4-RegExp.$1.length)));for(let s in e)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[s]:("00"+e[s]).substr((""+e[s]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r)));let h=["","==============\ud83d\udce3\u7cfb\u7edf\u901a\u77e5\ud83d\udce3=============="];h.push(e),s&&h.push(s),i&&h.push(i),console.log(h.join("\n")),this.logs=this.logs.concat(h)}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`\u2757\ufe0f${this.name}, \u9519\u8bef!`,t.stack):this.log("",`\u2757\ufe0f${this.name}, \u9519\u8bef!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`\ud83d\udd14${this.name}, \u7ed3\u675f! \ud83d\udd5b ${s} \u79d2`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
